+++
title = "Joint Coarse-and-Fine Reasoning for Deep Optical Flow"
date = 2017-09-15T00:00:00

# Authors. Comma separated list, e.g. `["Bob Smith", "David Jones"]`.
authors = ["Victor Vaquero", "German Ros","Francesc Moreno-Noguer", "Antonio M. Lopez","Alberto Sanfeliu"]

# Publication type.
# Legend:
# 0 = Uncategorized
# 1 = Conference proceedings
# 2 = Journal
# 3 = Work in progress
# 4 = Technical report
# 5 = Book
# 6 = Book chapter
publication_types = ["1"]

# Publication name and optional abbreviated version.
publication = "In *International Conference on Image Processing (ICIP)*, IEEE."
publication_short = "In *ICIP*"

# Abstract and optional shortened version.
abstract = "We propose a novel representation for dense pixel-wise estimation tasks using CNNs that boosts accuracy and reduces training time, by explicitly exploiting joint coarse-and-fine reasoning. The coarse reasoning is performed over a discrete classification space to obtain a general rough solution, while the fine details of the solution are obtained over a continuous regression space. In our approach both components are jointly estimated, which proved to be beneficial for improving estimation accuracy. Additionally, we propose a new  network architecture, which combines coarse and fine components by treating the fine estimation as a refinement built on top of the coarse solution, and therefore adding details to the general prediction. We apply our approach to the challenging problem of optical flow estimation and empirically validate it against state-of-the-art CNN-based solutions trained from scratch and tested on large optical flow datasets."

# Featured image thumbnail (optional)
image_preview= "icip_17_CaF/icip17_dummies.jpg"

# Is this a selected publication? (true/false)
selected = false

# Projects (optional).
#   Associate this publication with one or more of your projects.
#   Simply enter the filename (excluding '.md') of your project file in `content/project/`.
#projects = ["deep-learning"]

# Links (optional).
url_pdf = "http://www.iri.upc.edu/files/scidoc/1902-Joint-coarse-and-fine-reasoning-for-deep-optical-flow.pdf"
url_preprint = "http://arxiv.org/abs/1808.07416"
#  	Accepted in IEEE ICIP 2018. IEEE Copyrights: Personal use of this material is permitted. Permission from IEEE must be obtained for all other uses
#url_code = "#"
#url_dataset = "#"
#url_project = "#"
#url_slides = "#"
#url_video = "#"
url_poster = "https://drive.google.com/open?id=1O8YUfLNNIgka-j_Zv393X5y7EEZ5zqGU"
#url_source = "#"

# Custom links (optional).
#   Uncomment line below to enable. For multiple links, use the form `[{...}, {...}, {...}]`.
url_custom = [{name = "IEEE", url = "https://ieeexplore.ieee.org/document/8296744/"},
              {name = "IRI", url = "http://www.iri.upc.edu/publications/show/1902"}]

# Does the content use math formatting?
math = true

# Does the content use source code highlighting?
highlight = true

# Featured image
# Place your image in the `static/img/` folder and reference its filename below, e.g. `image = "example.jpg"`.
[header]
# image = "icip_17_CaF/icip17_main.jpg"
#image = "ICIP17_vvaquero.pdf.jpg"
# caption = "We approach dense per-pixel regression problems with a joint coarse-and-fine manner. We apply our method to the challenging optical flow problem explicitly combining a coarse result from pixel-wise horizontal and vertical classification problems with a fine one from regression predictions."
#caption = "We define a joint coarse-and-fine approach for standard per-pixel regression problems. We apply our method to the challenging optical flow problem explicitly combining a coarse result from pixel-wise horizontal and vertical classification problems with a fine one from regression predictions."


# More detail can easily be written after "+++" using *Markdown* and $\rm \LaTeX$ math code.

# DOI: 10.1109/ICIP.2017.8296744

# {{ < shortcode SMkwqS8XPyM > }}

# testImage](static/img/ICIP17_content.jpg)

#**Fig. 1. General Description**

+++



![icip_thumbnail](/img/thumbnails/ICIP_17_CaF.jpg "ICIP_17_Thumbnail")


## **Paper Summary**

![icip_main](/img/icip_17_CaF/icip17_main.jpg "ICIP_17_main_fig")
   
We approach dense per-pixel regression problems with a joint coarse-and-fine method and apply it to the challenging problem of optical flow prediction. 
Our method explicitly combines a coarse result based on the solution of pixel-wise horizontal and vertical classification problems with a fine one obtained through regression predictions.


### **Network Used**

![icip_net](/img/icip_17_CaF/icip_net.png "ICIP_17_net")
  
Our regularised FlowNet architecture is formed of a contractive and an expansive part. First, a set of Convolutions, Batch
Normalization and Relu layers (CONV, BN and RELU) are interleaved to obtain abstract and hierarchical representations while
contracting the input information. The final dense predictions is generated by deconvolution layers (CONV T ), and guided to an
optimal solution by concatenating (CAT blocks) corresponding initial feature maps and the partial coarse and fine upsampled
(Up) solutions obtained at five resolution points.


### **Coarse And Fine Module**

![icip_CaF_Module](/img/icip_17_CaF/icip_17_CaF_Module.png "ICIP_17_CaF_Module")
Each coarse-and-fine module solves one regression and two classification per-pixel problems. Softmax outputs from these last are declassified obtaining the coarse solution.


### **Results**
![icip_results](/img/icip_17_CaF/icip_17_results.png "ICIP_17_results")
Evaluation of the end-point-error for the presented models. Suffixes Kc indicate the number of classes used during training on Flying Chairs. 
Results over the Sintel Training and Test sets are presented, showing the generalization of our method on unseen datasets.

  
___
      
      




**Acknowledgements:** This work was partially supported by European AEROARMS project (H2020-ICT-2014-1-644271) and CICYT projects ColRobTransp (DPI2016-78957-R), ROBINSTRUCT (TIN2014-58178-R). 
Authors thank Nvidia for GPU hardware donation.
